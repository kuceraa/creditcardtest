<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  
  <title>CSCI 260 -- Homework 5: Learn Javascript</title>
  <script type="text/javascript">
    <!--
    function cardValidation(cardNumber) {  
      var validNumbers = "0123456789"  
      var length = cardNumber.length; 
      var integerCardNumber = parseInt(cardNumber);  
      var stringCardNumber = cardNumber.toString();  
      stringCardNumber = stringCardNumber.replace (/^\s+|\s+$/g,'');  
      var totalSum = 0;  
      var isItANumber = true;
      var notCardNumber = false;  
      var parsingString;  
      var digitValue;  

     
      for (var i=0; i<length; i++) {
        parsingString = "" + stringCardNumber.substring(i, i+1);
        if (validNumbers.indexOf(parsingString) == "-1"){
          isItANumber = false;
        }
      }

      
      if (!isItANumber) {
        notCardNumber = false;
      }

      
      if ((length == 0) && (notCardNumber)) {  
        notCardNumber = false;
      }
      else { 
        if (length >= 15) {  
          for (var i=length;i>0;i--) { 
            digitValue = parseInt(integerCardNumber) % 10;  
            digitValue = parseInt(digitValue); 
	    totalSum = totalSum + digitValue;
            i--;  
            integerCardNumber = integerCardNumber / 10;                   
            digitValue = parseInt(integerCardNumber) % 10;    
            digitValue = digitValue*2;                               

          
            switch(digitValue) {
              case 10: digitValue = 1; break;
		    	    
              case 12: digitValue = 3; break;  
		   
              case 14: digitValue = 5; break;  
		    
              case 16: digitValue = 7; break; 
		    
              case 18: digitValue = 9; break; 
		   
              default: digitValue = digitValue;    
            }
            integerCardNumber = integerCardNumber / 10; 
            totalSum = totalSum + digitValue;
          } 

          if ((totalSum%10)==0){  
            notCardNumber = true; 
          }
          else {
            notCardNumber = false; 
          }
        }
      }

   
      if (notCardNumber) {
        alert("Valid credit card number :)");
      }
      if (!notCardNumber) {
        alert("Not a valid credit card number");
      }
      return notCardNumber; 
    }
  </script>

</head>

<body>
 <h3>Credit Card Validation</h3>
  <form name="Form1">
      <tr>
          <input name="CreditCard" type="text" value="9999999999999999" size="18" maxlength="16">
      </tr>
      <tr>
          <input type="button" name="Button" value="TEST CARD NUMBER" onClick="return cardValidation(document.Form1.CreditCard.value);">
        </td>
      </tr>
  </form>
</div>	  
</body>
</html>
